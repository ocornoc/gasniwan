import "../../prims"
import "../../combinators"
import "../../combinator_ops"

let v: validator = validatehl <| literal_match "Hello, world!"

-- Testing literal, set, and empty matching
-- =========================================
-- input { [0x48u8, 0x65, 0x6c, 0x6c, 0x6f,
--  0x2c, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21] } output { true }
-- input { [0x68u8, 0x65, 0x6c, 0x6c, 0x6f,
--  0x2c, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21] } output { false }
-- input { [0x42u8, 0x79, 0x65, 0x2c, 0x20,
--  0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21] } output { false }
-- input { [0x62u8, 0x79, 0x65, 0x2c, 0x20,
--  0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21] } output { false }
-- input { [0x48u8, 0x65, 0x6c, 0x6c, 0x6f,
--  0x2c, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x3f] } output { false }
-- input { [0x68u8, 0x65, 0x6c, 0x6c, 0x6f,
--  0x2c, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x3f] } output { false }
-- input { [0x48u8, 0x65, 0x6c, 0x6c, 0x6f, 0x2c,
--  0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21, 0x3f] } output { true }
-- input { [0x68u8, 0x65, 0x6c, 0x6c, 0x6f, 0x2c,
--  0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64, 0x21, 0x3f] } output { false }

entry main (s: string): bool =
  v (new_mbpd s)
